# CS728 Programming Assignment 1

Word Embeddings and Named Entity Recognition.

## What this is

Five tasks exploring different approaches to learning word representations and using them for NER on the CoNLL-2003 dataset.

- **Task 1**: Train GloVe embeddings from scratch on CC-News data at dimensions 50, 100, 200, 300.
- **Task 2**: Generate word embeddings using Truncated SVD on a term-document matrix.
- **Task 3**: Named Entity Recognition with a CRF using hand-crafted features (lexical, shape, sub-word, boundary).
- **Task 4**: NER with a simple MLP that takes a single token embedding as input. Compares GloVe vs SVD embeddings.
- **Task 5** (Extra Credit): Apply TF-IDF weighting before SVD and check if it improves embedding quality and NER performance.

## Files

| File | Purpose |
|------|---------|
| `utils.py` | Shared functions: co-occurrence builder, term-doc matrix, nearest neighbors, vocab loader |
| `task1.py` | GloVe training loop, loss/latency plots |
| `task2.py` | SVD pipeline, latency plot |
| `task3.py` | CRF feature engineering, training, evaluation |
| `task4.py` | MLP model, NERDataset with OOV handling, training/eval across all embedding types |
| `task5.py` | TF-IDF + SVD experiment, neighbor comparison, MLP evaluation |
| `report.tex` | LaTeX report with results and analysis |

## Data (not included)

The following files are too large for git and need to be generated or copied from the original source:

- `updated_vocab_document_dict.json` (1.2 GB) - CC-News vocabulary and document data
- `cooc_cache_w10.pkl` (638 MB) - Cached co-occurrence matrix (generated by Task 1 on first run)
- `embeddings/*.npy` - Pre-trained embedding files (generated by Tasks 1 and 2)

## How to run

Each task file runs independently as a script. Run them in order since later tasks depend on outputs from earlier ones.

```
python task1.py   # trains GloVe, saves embeddings
python task2.py   # runs SVD, saves embeddings
python task3.py   # trains CRF, prints metrics
python task4.py   # trains MLPs using saved embeddings, prints comparison table
python task5.py   # runs TF-IDF experiment
```

Requires a GPU for Task 1 (GloVe training). Tasks 2-5 run fine on CPU.

## Dependencies

Python 3.10+, PyTorch, NumPy, SciPy, scikit-learn, sklearn-crfsuite, HuggingFace datasets, matplotlib, tqdm.

## Team

22b1279, 22b1233
